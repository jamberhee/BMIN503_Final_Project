---
title: "Association between communication difficulty and high impact pain in U.S. adults"
subtitle: "BMIN503/EPID600 Final Project"
author: "Amber Rhee, MHS"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers. Feel free to change the theme and other display settings, although this is not required. I added a new sentence

## Overview {#sec-overview}

Give a brief a description of your project and its goal(s), what data you are using to complete it, and what two faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.

For my final project, I am using data from the 2023 NHIS's (Sample Adult) communication core and chronic pain content to examine the association between one's communication ability (which can, e.g., translate into ability to communicate symptoms to providers) and high impact pain (pain defined as significant enough to limit daily activities). John Farrar, MD, PhD has helped me consider potential confounders and effect modifiers that may affect the association between my variables of interest, while Adam Naj, PhD has helped me decide how I want to model the actual data in my analyis.

[Final Project Repo](https://github.com/jamberhee/BMIN503_Final_Project)

## Introduction {#sec-introduction}

Describe the problem addressed, its significance, and some background to motivate the problem. This should extend what is in the @sec-overview.

Chronic pain is a major public health concern in the U.S., with high prevalence across sociodemographic groups \[1\]. The incidence of chronic pain cases is reported greater than the incidence of diabetes, depression, and hypertension \[2\] And disparities in pain management are significant \[3\].

The official definition of pain acknowledges pain as a subjective experience, where an individual's report of pain is to be respected \[4\]. It also notes, "inability to communicate does not negate the possibility that a human \[…\] experiences pain" \[4\].

Communication requires both a patient to properly express their symptoms and a healthcare provider to listen and understand. Verbal communication is considered the "gold standard" for pain assessment \[5\]. A review found that a major reason for provider dismissal and downgrading of patient credibility regarding their pain was due to ineffective pain communication by the patient \[5\]. Additional qualitative research has found healthcare providers view pain assessment in individuals with communication difficulties to be challenging and time-consuming \[6\]. And yet, disparities in pain in relation to communication difficulties are not well documented or quantified.

References

1.  Rikard SM, Strahan AE, Schmit KM, Guy GP Jr.. Chronic Pain Among Adults — United States, 2019–2021. MMWR Morb Mortal Wkly Rep 2023;72:379–385. DOI: http://dx.doi.org/10.15585/mmwr.mm7215a1
2.  Nahin RL, Feinberg T, Kapos FP, Terman GW. Estimated Rates of Incident and Persistent Chronic Pain Among US Adults, 2019-2020. JAMA Netw Open. 2023 May 1;6(5):e2313563. doi: 10.1001/jamanetworkopen.2023.13563. PMID: 37191961; PMCID: PMC10189566.
3.  Nguyen LH, Dawson JE, Brooks M, Khan JS, Telusca N. Disparities in Pain Management. Anesthesiol Clin. 2023 Jun;41(2):471-488. doi: 10.1016/j.anclin.2023.03.008. PMID: 37245951.
4.  Raja SN, Carr DB, Cohen M, Finnerup NB, Flor H, Gibson S, Keefe FJ, Mogil JS, Ringkamp M, Sluka KA, Song XJ, Stevens B, Sullivan MD, Tutelman PR, Ushida T, Vader K. The revised International Association for the Study of Pain definition of pain: concepts, challenges, and compromises. Pain. 2020 Sep 1;161(9):1976-1982. doi: 10.1097/j.pain.0000000000001939. PMID: 32694387; PMCID: PMC7680716.
5.  Sabater-Gárriz Á, Molina-Mula J, Montoya P, Riquelme I. Pain assessment tools in adults with communication disorders: systematic review and meta-analysis. BMC Neurol. 2024 Feb 17;24(1):66. doi: 10.1186/s12883-024-03539-w. PMID: 38368314; PMCID: PMC10873938.
6.  Tosas MR. The downgrading of pain sufferers' credibility. Philos Ethics Humanit Med. 2021 Oct 6;16(1):8. doi: 10.1186/s13010-021-00105-x. PMID: 34610826; PMCID: PMC8493671.

Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.

Because pain is defined by a biopsychosocial model, meaning physiological, psychological, and social factors all play an integral role, interacting with each other to create pain outcomes \[7\], attempting to study pain at the population level is, thus, an intricate task. I could benefit to receive inputs from general practitioners, pain specialists, psychologists, and even behavioral and social scientists to gain insights on my research question but also from epidemiologists to learn to how I can explore this question in a nationally-representative survey and what considerations I have to make in the process. Dr. John Farrar, as both a clinical epidemiologist and pain clinician, has helped me conceptualize my causal framework for this analysis, particularly when thinking about potential confounders. Dr. Adam Naj, as an epidemiologist, has helped me identify how to best model my data and think about data missingness.

References

7.  Meints SM, Edwards RR. Evaluating psychosocial contributions to chronic pain outcomes. Prog Neuropsychopharmacol Biol Psychiatry. 2018 Dec 20;87(Pt B):168-182. doi: 10.1016/j.pnpbp.2018.01.017. Epub 2018 Jan 31. PMID: 29408484; PMCID: PMC6067990.

## Methods {#sec-methods}

Describe the data used and general methodological approach used to address the problem described in the @sec-introduction. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why.

I used "Sample Adult" data from the 2023 National Health Interview Survey (NHIS). Estimates from the NHIS are designed to be representative of the noninstitutionalized civilian population of the U.S.

> Install and load libraries

```{r message=FALSE}
# install.packages("tidyverse)
# install.packages("survey")
# install.packages("gtsummary")

library(tidyverse)
library(survey)
library(table1)
library(corrplot)
library(gtsummary)
```

> Load data

```{r}
## loaded according to recommended/provided code from NHIS
### prevents errors in reading in data file due to missingness in data
adult2023 <- read_csv("adult23.csv", guess_max = 29522)

## https://ftp.cdc.gov/pub/Health_Statistics/NCHS/Datasets/NHIS/2023/adult23csv.zip

```

Communication difficulty was determined by the question, "Using your usual language, do you have difficulty communicating, for example, understanding or being understood?" Participants could respond, "No difficulty", "Some difficulty", "A lot of difficulty", or "Cannot do at all." Due to small sample size, I collapsed the "A lot of difficulty" and "Cannot do at all" participants into a single group.

Participants were asked, "In the past three months, how often did you have pain?", to which they could answer, "Never," "Some days," "Most days," or "Every day." Only those who reported any pain to this question were asked the follow question: "Over the past three months, how often did your pain limit your life or work?" High impact pain was defined as pain that limited life or work "Most days" or "Every day." Participants who responded "Never" or "Some days" or reported no pain in the last three months were classified as individuals without high impact pain.

> Initial inspection of data for sample size

```{r}
## check unique adults in dataset
### 29522 adults--one row per participant
length(unique(adult2023$HHX))

## change missing to NA
## convert comm difficulty variable to factor
## collapse lots + completely due to small cell size
adult2023 <- adult2023 %>% 
  mutate(COMDIFF_A = as.factor(case_when(adult2023$COMDIFF_A > 4 ~ NA,
                               adult2023$COMDIFF_A == 4 |
                                 adult2023$COMDIFF_A == 3 ~ "Lots or Completely",
                               adult2023$COMDIFF_A == 2 ~ "Some",
                               adult2023$COMDIFF_A == 1 ~ "None")))
adult2023$COMDIFF_A <- factor(adult2023$COMDIFF_A, 
                              levels = c("None","Some","Lots or Completely"))
table(adult2023$COMDIFF_A,useNA = "always")

## change missing to NA
## convert high impact pain variable to factor
adult2023$PAIWKLM3M_A <- ifelse(adult2023$PAIWKLM3M_A > 4, NA, adult2023$PAIWKLM3M_A)
adult2023$PAIWKLM3M_A <- factor(adult2023$PAIWKLM3M_A,
                                labels = c("Never","Some","Most","Every"))
table(adult2023$PAIWKLM3M_A)

## create pain binary variable for outcome
adult2023 <- adult2023 |>
  mutate(hip_binary = ifelse(adult2023$PAIWKLM3M_A == "Never" |
                               adult2023$PAIWKLM3M_A == "Some", 0, 1))

## examine outcome for sample size
table(adult2023$hip_binary)
prop.table(table(adult2023$COMDIFF_A,adult2023$hip_binary),2)
```

> Examine sampling

```{r}
## rename variables of interest
## 7 participants missing exposure
## cannot filter out individuals because
### all of the strata need to be used in the calculation of the standard error
data <- adult2023 %>% 
  as.data.frame() %>% 
  rename(id = HHX,
         strata = PSTRAT,
         sweight = WTFA_A,
         psu = PPSU,
         comdiff = COMDIFF_A,
         pain = PAIFRQ3M_A,
         hip = PAIWKLM3M_A)

## if participants have no pain, no hip also
data <- data %>% 
  mutate(hip = ifelse(pain == 1, 1, hip)) %>%
  mutate(hip_binary = ifelse(pain == 1, 0, hip_binary))
weighted_data_test <-svydesign(id=~psu, weights=~sweight,
                          strata=~strata, nest=TRUE,
                          data = data)

summary(weighted_data_test)

svytable(~comdiff+hip, weighted_data_test)
svytable(~comdiff+hip_binary, weighted_data_test)
```

Confounders and effect modifiers were identified a priori from the literature and discussed with Dr. Farrar. My hypothetical causal framework is depicted in a directed acyclic graph (DAG) below. Of my proposed confounders, 2 were not captured in the data--autism and stress. They cannot, thus, be controlled for the in the analysis. I used "use of a hearing aid" as a proxy for hearing loss. All conditions (stroke, dementia, fatigue, anxiety) are ever-diagnoses.

> Identify confounders

```{r}
knitr::include_graphics("dag_1122.png")
```

Because the communication variable asked about communication in one's usual language, I decided to explore whether there was effect modification if one's primary language differed with the language they used at the doctor's. Participants were asked, first, whether they spoke a language other than English at home. If they responded yes, they were asked follow-up questions on what language they used when consuming media (watching television, reading news, or listening to the radio), seeing a doctor or other health care professional, and participating in social activities (visiting friends, clubs and meetings, going to parties). Participants could answer "English," "Other language" or refuse/report unknown. If participants answered "Other language" for any of the follow-up questions, they were classified as having a non-English primary language. If a participant had a non-English primary language and reported using English with their healthcare provider, they were classified as a "no match". If they had a non-English primary language and reported using their other language with their healthcare provider, they were classified as a "match". Participants who reported no second language were automatically classified as a "match." Participants were stratified by language "match" and "no match" to explore potential effect modification.

Due to a high level of missingness (\~30%) in language variables, I decided to stratify by primary language in a subgroup analysis instead of the entire analytic population.

> Finalize data set before weighting

```{r}
## rename variables of interest (confounders, effect modifiers)
## isolate variables i want to work with
data <- data %>% 
  rename(lang_other = LANGHM_A,
         lang_tv = LANGMED_A,
         lang_doc = LANGDOC_A,
         lang_soc = LANGSOC_A,
         race = HISPALLP_A,
         age = AGEP_A,
         hearing = HEARAID_A,
         dementia = DEMENEV_A,
         fatigue = CFSEV_A,
         anxiety = ANXEV_A,
         sex = SEX_A,
         stroke = STREV_A) %>% 
  select(id,strata,sweight,psu,comdiff,pain,hip,hip_binary,
         lang_other,lang_tv,lang_doc,lang_soc,race,age,
         hearing,dementia,fatigue,anxiety,sex,stroke)

summary(data)

## check how many individuals i lose with complete case
## 932 (3% of total sample) missing outcome
dim(subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke)))

## make na values na
cols <- c(6,9:12,15:20)
data <- data %>% 
  mutate(across(all_of(cols), ~ if_else(.x >= 7, NA_real_, .x))) %>% 
  mutate(age = ifelse(age > 85, NA, age))

## check for correlation between conditions
vars <- data[, c(15:18,20)]
vars01 <- as_tibble(ifelse(vars == 2, 1, 0))
cor_mat <- cor(vars01,use = "pairwise.complete.obs")
corrplot(cor_mat, method = "color",
         type = "upper", tl.col = "black", tl.cex = 0.7)

## convert pain var to factors
data[,6:7] <- lapply(data[,6:7], factor,
                       levels = c(1:4),
                       labels = c("Never", "Some", "Most", "Every"))

## identify those reporting any other language as primary
data <- data %>% 
  mutate(across(lang_tv:lang_soc, ~ as.factor(case_when(.x == 1 ~ "English",
                                              is.na(.x) ~ "Missing",
                                              .x == 2 ~ "Other language"))),
         primary_other = as.factor(ifelse(if_any(lang_tv:lang_soc, ~ .x == "Other language"),"Yes",NA)))
primary <- data %>% 
  filter(is.na(primary_other)) %>% 
  mutate(primary_English  = as.factor(ifelse(if_any(lang_tv:lang_soc, ~ .x == "English"),"No",NA)))
data <- data %>% 
  mutate(primary_other = factor(primary_other,
                                levels = c("No","Yes")),
         primary_other = as.factor(ifelse(data$id %in% subset(primary,primary_English == "No")$id, 2, data$primary_other)))

## convert language vars to factors
data[data == "Missing"] <- NA
data[,10:12] <- lapply(data[,10:12], droplevels)

## convert y/n vars to factors
data[,c(9,15:18,20:21)] <- lapply(data[,c(9,15:18,20:21)], factor,
                       levels = c(1,2),
                       labels = c("Yes", "No"))

## make "no" the ref groups in y/n vars
data[,c(9,15:18,20:21)] <- lapply(data[,c(9,15:18,20:21)], relevel,
                            ref = "No")

## convert remaining vars to factors                    
data <- data %>% 
  mutate(id = factor(id),
         hip_binary = factor(hip_binary,
                             levels = c(0,1),
                             labels = c("No","Yes")),
         race = factor(race,
                       levels = c(1:7),
                       labels = c("Hispanic","NH White","NH Black",
                                  "NH Asian", "NH AIAN only", "NH AIAN and other",
                                  "Other/Multi")),
         sex = factor(sex,
                      levels = c(1,2),
                      labels = c("Male","Female")))

## create variable for whether otherlang matches with lang_doc
## if don't speak second language other than English (lang_other),
### assume primary language matches with language used at doctors
data <- data %>% 
  mutate(lang_match = as.factor(case_when(lang_other == "No" ~ "Match",
                                          lang_doc == "English" & primary_other == "No" ~ "Match",
                                          lang_doc == "Other language" & primary_other == "Yes" ~ "Match",
                                          lang_doc == "English" & primary_other == "Yes" ~ "No match",
                                          lang_doc == "Other language" & primary_other == "No" ~ "No match",
                                          TRUE ~ NA)))

summary(data)

## save data as r data file for future easy loading
# save(data, file = "data.Rda")
# load("data.Rda")
```

Participants missing the exposure, outcome, or both variables were excluded from the calculation of the estimates. This resulted in a loss of approximately 3% of participants. The R package survey 4.4-8 allows for these excluded participants to stay included for the calculation of the standard errors. With the survey package, the data set was weighted according to the weights provided by the NHIS data set.

I conducted a logistic regression of communication difficulty on high impact pain, adjusted for sex, race/ethnicity, age (continuous), hearing loss, dementia, fatigue, anxiety, and stroke. All confounders were included as factors, unless otherwise specified.

> Apply weighting and logistic regression

```{r}
## apply weighting
weighted_data <- svydesign(id=~psu, weights=~sweight,
                          strata=~strata, nest=TRUE,
                          data = data)

## check number of individuals represented
sum(weights(weighted_data))

## create subset of complete cases
weighted_sub <- subset(weighted_data, complete.cases(comdiff,hip_binary,sex,
                                                     race,age,hearing,dementia,
                                                     fatigue,anxiety,stroke))

## check to see that subsetting / weighting done correctly
svymean(~age,weighted_sub)
svyby(~age,~I(complete.cases(comdiff,hip_binary,sex,
                                                     race,age,hearing,dementia,
                                                     fatigue,anxiety,stroke)),weighted_data,svymean)

## check new number of individuals represented
sum(weights(weighted_sub))


## fit univariate model
fit1_sub <- svyglm(hip_binary~comdiff,
                  family=quasibinomial,
                  design=weighted_sub, na.action = na.omit)

## fit demographic vars
fit2_sub <- svyglm(hip_binary~comdiff+sex+race+age,
                  family=quasibinomial,
                  design=weighted_sub, na.action = na.omit)
  
## fit all covariates
fit3_sub <- svyglm(hip_binary~comdiff+sex+race+age+hearing+dementia+fatigue+anxiety+stroke,
                  family=quasibinomial,
                  design=weighted_sub, na.action = na.omit)

## check results
summary(fit1_sub)
summary(fit2_sub)
summary(fit3_sub)

## put in data frame
results_null <- rownames_to_column(as.data.frame(summary(fit1_sub)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = round(exp(Estimate),digits = 2),
         lower.CI = round(exp(Estimate - 1.96*`Std. Error`),digits = 2),
         upper.CI = round(exp(Estimate + 1.96*`Std. Error`),digits = 2),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)
  

## put in data frame
results_full <- rownames_to_column(as.data.frame(summary(fit3_sub)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = exp(Estimate),
         lower.CI = exp(Estimate - 1.96*`Std. Error`),
         upper.CI = exp(Estimate + 1.96*`Std. Error`),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)

```

As a subgroup analysis, I conducted the same logistic regression of communication difficulty on high impact pain, adjusted for sex, race/ethnicity, age (continuous), hearing loss, dementia, fatigue, anxiety, and stroke, but I restricted my analysis to those who had data on primary language language. Similar to the main analysis, I used a complete cases only.

> Apply subsetting + regression for subgroup analysis

```{r}
## create subset of complete cases, including lang_match as new covariate
weighted_sub2 <- subset(weighted_data, complete.cases(comdiff,hip_binary,sex,
                                                     race,age,hearing,dementia,
                                                     fatigue,anxiety,stroke,lang_match))

## check new number of individuals represented
sum(weights(weighted_sub2))

## check number of individuals in actual dataset
dim(subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke,lang_match)))

##further subset datasets into strata by lang_match
weighted_sub_match <- subset(weighted_sub2, lang_match == "Match")
weighted_sub_nomatch <- subset(weighted_sub2, lang_match == "No match")

## check number of individuals represented by each strata
sum(weights(weighted_sub_match))
sum(weights(weighted_sub_nomatch))

## check number of individuals in actual strata
dim(subset(subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke,lang_match)),lang_match == "Match"))
dim(subset(subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke,lang_match)),lang_match == "No match"))

## check to see that subsetting / weighting done correctly
svymean(~age,weighted_sub_match)
svyby(~age,~I(lang_match == "Match"),weighted_sub2,svymean)
svymean(~age,weighted_sub_nomatch)
svyby(~age,~I(lang_match == "No match"),weighted_sub2,svymean)


## fit univariate model
fit1_sub_match <- svyglm(hip_binary~comdiff,
                  family=quasibinomial,
                  design=weighted_sub_match, na.action = na.omit)
fit1_sub_nomatch <- svyglm(hip_binary~comdiff,
                  family=quasibinomial,
                  design=weighted_sub_nomatch, na.action = na.omit)

## fit full model
fit3_sub_match <- svyglm(hip_binary~comdiff+sex+race+age+hearing+dementia+fatigue+anxiety+stroke,
                         family=quasibinomial,
                         design=weighted_sub_match, na.action = na.omit)
fit3_sub_nomatch <- svyglm(hip_binary~comdiff+sex+race+age+hearing+dementia+fatigue+anxiety+stroke,
                         family=quasibinomial,
                         design=weighted_sub_nomatch, na.action = na.omit)

## check results
summary(fit1_sub_match)
summary(fit1_sub_nomatch)
summary(fit3_sub_match)
summary(fit3_sub_nomatch)

## put in data frame
results_match_null <- rownames_to_column(as.data.frame(summary(fit1_sub_match)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = round(exp(Estimate),digits = 2),
         lower.CI = round(exp(Estimate - 1.96*`Std. Error`),digits = 2),
         upper.CI = round(exp(Estimate + 1.96*`Std. Error`),digits = 2),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)

results_match_full <- rownames_to_column(as.data.frame(summary(fit3_sub_match)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = round(exp(Estimate),digits = 2),
         lower.CI = round(exp(Estimate - 1.96*`Std. Error`),digits = 2),
         upper.CI = round(exp(Estimate + 1.96*`Std. Error`),digits = 2),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)

results_nomatch_null <- rownames_to_column(as.data.frame(summary(fit1_sub_nomatch)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = round(exp(Estimate),digits = 2),
         lower.CI = round(exp(Estimate - 1.96*`Std. Error`),digits = 2),
         upper.CI = round(exp(Estimate + 1.96*`Std. Error`),digits = 2),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)

results_nomatch_full <- rownames_to_column(as.data.frame(summary(fit3_sub_nomatch)$coef),
                                   var = "Communication Difficulty Level") %>% 
  mutate(or = round(exp(Estimate),digits = 2),
         lower.CI = round(exp(Estimate - 1.96*`Std. Error`),digits = 2),
         upper.CI = round(exp(Estimate + 1.96*`Std. Error`),digits = 2),
         `Pr(>|t|)` = signif(`Pr(>|t|)`, digits = 3),
         `Std. Error` = round(`Std. Error`, digits = 3)) %>% 
  select(1,6,3,7:8,5)

```

## Results {#sec-results}

Describe your results and include relevant tables, plots, and code/comments used to obtain them. You may refer to the @sec-methods as needed. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.

### Study Population

Table 1 shows selected characteristics of the U.S. adults examined in our analysis divided by communication difficulty. We examined N=28,444 respondents, representing a weighted N=248,826,036 individuals. Individuals with greater communication difficulty were more likely to be male, older and have ever diagnoses of dementia, anxiety, stroke, and hearing loss.

```{r}
table1_data <- subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke))
## set var names
labels <- list(
    variables=list(sex="Sex",
                   age="Age (years)",
                   race = "Race and Ethnicity",
                   dementia="Dementia",
                   fatigue="Fatigue",
                   anxiety = "Anxiety",
                   stroke = "Stroke",
                   hearing = "Hearing loss"),
    groups=list("", "Communication Difficulty"))

## create strata for table
strata <- c(list(Total=table1_data), split(table1_data, table1_data$comdiff))

## generate table1
table1 <- table1(strata,labels,groupspan=c(1,3),
                 data=table1_data,overall=c(left="Total"),
                 caption="Table 1. Sample Characteristics")
table1 
```

### Associations between communication difficulty and high impact pain

The association between communication difficulty level and high impact pain was statistically significant in U.S. adults before and after adjusting for covariates. Compared to those with no communication difficulty, adjusting for covariates, those with some communication difficulty had 2.23 times greater odds of high impact pain (95% CI, 1.88-2.63%; p\<0.001), while those with lots of or complete communication difficulty had 2.58 times greater odds of high impact pain (95% CI, 1.79-3.71%; p\<0.001) (Table 2).

```{r}
## main analysis output
results_null_gt <- tbl_regression(fit1_sub, exponentiate = T,
                                  label = list(comdiff = "Communication Difficulty Level"))

results_full_gt <- tbl_regression(fit3_sub, exponentiate = T,
                                  include = "comdiff",
                                  label = list(comdiff = "Communication Difficulty Level"))

## put into single table
table2 <-
  tbl_merge(
    tbls = list(results_null_gt, results_full_gt),
    tab_spanner = c("**Univariate Model**", "**Multivariate Model**")
  ) %>% 
  modify_caption("**Table 2. Logistic Regression Results**")

table2
```

### Subgroup Analysis

Table 3 shows selected characteristics of the U.S. adults examined in our subgroup analysis by language strata and communication difficulty. We examined n=19,485 respondents, representing a weighted n=184,316,475 U.S. adults. Hispanics and NH Asians were overrepresented in the language no-match stratum, which consisted of n=831 adults (weighted n=8,454,144 individuals).

```{r}
table3_data_sub <- subset(data, complete.cases(comdiff,hip_binary,sex,
                                race,age,hearing,dementia,
                                fatigue,anxiety,stroke,lang_match))

## set var names
labels <- list(
    variables=list(sex="Sex",
                   age="Age (years)",
                   race = "Race and Ethnicity",
                   dementia="Dementia",
                   fatigue="Fatigue",
                   anxiety = "Anxiety",
                   stroke = "Stroke",
                   hearing = "Hearing loss"),
    groups=list("Total", "Match", "No Match"))

## create strata for table
strata <- c(list(Total=table3_data_sub),
            split(table3_data_sub, table3_data_sub$comdiff),
            list("Total"=subset(table3_data_sub, lang_match=="Match")),
            split(subset(table3_data_sub, lang_match=="Match"),
                  subset(table3_data_sub, lang_match=="Match")$comdiff),
            list("Total"=subset(table3_data_sub, lang_match=="No match")),
            split(subset(table3_data_sub, lang_match=="No match"),
                  subset(table3_data_sub, lang_match=="No match")$comdiff))

## generate table1
table3 <- table1(strata,labels,groupspan=c(4,4,4),
                 data=table3_data_sub,overall=c(left="Total"),
                 caption="Table 3. Subgroup Sample Characteristics")
table3 

```

In the language matrch statum, compared to those with no communication difficulty, adjusting for covariates, those with some communication difficulty had 2.32 times greater odds of high impact pain (95% CI, 1.90-2.82%; p\<0.001), while those with lots of or complete communication difficulty had 2.85 times greater odds of high impact pain (95% CI, 1.87-4.33%; p\<0.001) (Table 4a). These results are similar to that in the full analytic sample.

In the language no-match stratum, compared to those with no communication difficulty, adjusting for covariates, those with some communication difficulty had 1.41 times greater odds of high impact pain (95% CI, 0.42-4.75; p=0.577), while those with lots of or complete communication difficulty had 3.80 times greater odds of high impact pain (95% CI, 0.56-25.9; p=0.172) (Table 4b). Though none of these results were statistically significant, this may be due to limited power. The effect sizes are much higher in the no-match stratum compared to that in the match stratum and the main analysis, suggesting possible effect modification.

```{r}
## subgroup analysis output
## match tables
results_match_null_gt <- tbl_regression(fit1_sub_match, exponentiate = T,
                                  label = list(comdiff = "Communication Difficulty Level"),
                                  pvalue_fun = label_style_pvalue(digits = 3))
results_match_full_gt <- tbl_regression(fit3_sub_match, exponentiate = T,
                                  include = "comdiff",
                                  label = list(comdiff = "Communication Difficulty Level"),
                                  pvalue_fun = label_style_pvalue(digits = 3))
table4a <-
  tbl_merge(
    tbls = list(results_match_null_gt, results_match_full_gt),
    tab_spanner = c("**Univariate Model**", "**Multivariate Model**")
  ) %>% 
  modify_caption("**Table 4a. Language Match Regression Results**")
table4a

## no match tables
results_nomatch_null_gt <- tbl_regression(fit1_sub_nomatch, exponentiate = T,
                                  label = list(comdiff = "Communication Difficulty Level"),
                                  pvalue_fun = label_style_pvalue(digits = 3))
results_nomatch_full_gt <- tbl_regression(fit3_sub_nomatch, exponentiate = T,
                                  include = "comdiff",
                                  label = list(comdiff = "Communication Difficulty Level"),
                                  pvalue_fun = label_style_pvalue(digits = 3))

table4b <-
  tbl_merge(
    tbls = list(results_nomatch_null_gt, results_nomatch_full_gt),
    tab_spanner = c("**Univariate Model**", "**Multivariate Model**")
  ) %>% 
  modify_caption("**Table 4b. Language No-Match Regression Results**")
table4b

```

## Conclusion

This the conclusion. The @sec-results can be invoked here.

Individuals with communication difficulty represent an understudied group in pain outcomes research. Communication difficulty was significantly associated with high impact pain, for both some and lots of or complete difficulty when compared to no difficulty. Subgroup analysis suggests effect modification by whether one's language used at the doctor's differed from their primary language. Those with differing language observed worse pain outcomes, though this did not reach statistical significance. Our findings indicate the need for increased research in both pain assessment and management in this growing vulnerable population, particularly for those who do not use their primary language at the doctor's. Study limitations include possible recall bias, use of cross-sectional data, and high missing-ness in the subgroup analysis.
